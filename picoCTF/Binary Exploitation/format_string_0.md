# format string 0

## Challenge

Can you use your knowledge of format strings to make the customers happy? Download the binary here. Download the source here.

Additional details will be available after launching your challenge instance.

## Solving

We start off with a large C file.

I look at the block of code that runs when we run the file:

```

void serve_patrick() {
    printf("%s %s\n%s\n%s %s\n%s",
            "Welcome to our newly-opened burger place Pico 'n Patty!",
            "Can you help the picky customers find their favorite burger?",
            "Here comes the first customer Patrick who wants a giant bite.",
            "Please choose from the following burgers:",
            "Breakf@st_Burger, Gr%114d_Cheese, Bac0n_D3luxe",
            "Enter your recommendation: ");
    fflush(stdout);

    char choice1[BUFSIZE];
    scanf("%s", choice1);
    char *menu1[3] = {"Breakf@st_Burger", "Gr%114d_Cheese", "Bac0n_D3luxe"};
    if (!on_menu(choice1, menu1, 3)) {
        printf("%s", "There is no such burger yet!\n");
        fflush(stdout);
    } else {
        int count = printf(choice1);
        if (count > 2 * BUFSIZE) {
            serve_bob();
        } else {
            printf("%s\n%s\n",
                    "Patrick is still hungry!",
                    "Try to serve him something of larger size!");
            fflush(stdout);
        }
    }
}
```
I look closely at the code, and realise the weird %s and %d dotted everywhere. I enter in a large string to see if something breaks, but nothing happens. I see the **%114d** in Gr%114d_Cheese, which pads any input to 114 digits, and I simply just try to input a 115 digit number to see what happens. Lo and Behold, It prints out the flag **picoCTF{7h3_cu570m3r_15_n3v3r_SEGFAULT_ef312157}**.

This was pure luck, So I decided to read the source code and see why it worked.

I see that scanf is used to take in input into the variable choice1. and choice1 has a buffer size of 32. If I input a really large number, it will overflow the buffer and cause a segmentation fault. This segmentation fault is then caught by the signal function, Which prints out the flag.